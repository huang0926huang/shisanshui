<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>软件工程</title>	
<style>  /*在文档头部定义内部样式表*/
.login{
	width: 280px;
	margin-left:380px;  /*不要在属性值与单位之间留有空格*/
	margin-top: 200px;
	}
body{
		background-image:url("QQ图片20191003113621.jpg");
	    background-repeat:  no-repeat;
	}
</style>
</head>

<body>
<table class=login  width="250"  border="2" cellspacing="0" cellpadding="0">
 	<tr height="30" style="background:  #19A77E">
		<td align="center" >登录</td>
 	</tr>	
	
 	<tr style="background: #CBDED7">
 		<td  height="100">
			<table>
 			<tr>
 				<td>用&nbsp; 户：</td>
 				<td><input id="username" type="text" name="username" value="" size="20" maxlength="20" </td>
 			</tr>
 			<tr>
 				<td>密  码：</td>
 				<td><input id="password" type="text" name="password" value="" size="20" maxlength="20" </td>
 			</tr>
 			</table>
 		</td>
	</tr> 
	
	<tr style="background: #DEDEDE">
		<td>
  			<table align="center">
   			<tr>
				  <td><input type="button" name="login" value="登录" onclick="mylogin()"></td>
				  <td><input type="reset" name="rs" value="重置"></td>
				  <td><a href="注册.html"><input type="button" name="button" value="注册" ></a></td>				
 	        </tr>
			</table>
 		</td>
</table>


<script>
mylogin=function(){
        if(document.getElementById("username").value=="" || document.getElementById("password").value=="")
        {alert("账号和密码不能为空");return ;}
        else{
            var data = JSON.stringify({
                "username": document.getElementById("username").value,
                "password": document.getElementById("password").value
            })
            var xhr = new XMLHttpRequest();
            xhr.onreadystatechange=function(){
                if(xhr.readyState==4&&xhr.status==200){
                    var json=JSON.parse(xhr.responseText);
                    alert("登陆成功");
                    localStorage.removeItem("token");
                    localStorage.removeItem("user_id");
                    localStorage.setItem("token",json.data.token);
                    localStorage.setItem("user_id",json.data.user_id);
                    window.location.href='首页.html';
                    console.log(xhr.responseText);
                }
            }
            xhr.open("POST", "http://api.revth.com/auth/login",true);
			//xhr.setRequestHeader("x-auth-token",token); 
            xhr.setRequestHeader("content-type", "application/json");
            xhr.send(data);
        }
    }
  </script>
	
</body>
</html>
